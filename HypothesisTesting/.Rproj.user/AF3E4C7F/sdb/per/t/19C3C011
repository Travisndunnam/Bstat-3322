{
    "contents" : "---\ntitle: \"HYpothesis Testing using Ranomization Distributions\"\nauthor: \"by Craig W. Slinkman\"\ndate: \"October 22, 2015\"\noutput: word_document\n---\n\n#Q1: \nA certain chemical pollutant in the Genesee River has been constant for several years with mean Î¼ = 34 ppm (parts per million). A group of factory representatives whose companies discharge liquids into the river is now claiming that they have lowered the average with improved filtration devices. A group of environmentalists will test to see if this is true at the 5% level of significance. They have drawn a random sample of size 25 from the river.  The sample values are given below in the vector $PPM$.  \n\n```{r, Q1.0,echo=FALSE}\nset.seed( 11235 )\nPPM <- round( rnorm( 25 , 32, 9 ))\nPPM\n```\n\n## The null null hypothesis  and alternative hypothothesis\nThe envronment group wants to test  the claim that the level of the pollutant is lower than 34 ppm.  So are null and alternative hypothesis are: $$NH: \\mu=34$$\n$$AH: \\mu<34$$\n\n\nPerform a hypothesis test (6 step procedure outlined in class) at the 4% level of\nsignificance and state your decision. \n\n## Graphics and descriptive statistics\nThe first set in statistical analysis is to draw a suitable grpahic.  When analyzing quanitative data with the small sample sizes the dotplot is the ideal graphic. \n\n```{r Q1.1}\nrequire( ggplot2 )\n\nggplot( data.frame( PPM ),\n        aes( x=PPM )) +\n    geom_dotplot( binwidth = 1 ) +\n    xlab( \"Pollutant (PPM)\" ) +\n    ylab( \"Count\" ) +\n    ggtitle( \"Genesee River Pollutant Measurements\")\n    \n ybar <- round( mean(PPM), 1) \n s    <- round( sd( PPM ), 1)\n\n```\n\n$$\\bar{y}=`r ybar`$$\n$$s=`r s`$$\n\n## Creating the ranomization distribution for the hypothesis test\nWe must adjust the sample data so that it centered around the null hypothesis value.  We do this by subtracting the sample mean from each sample value and then adding the null hypothesis value to each observation. \n\nIn R we do this as follows.  \n\n```{r Q1.2}\nmuNH <- 34                     # NH value\nadjusted <- PPM - ybar + 34    # Adjust sample mean to NH value.\nadjusted\ncat( \"mean(Adjusted)=\", round(mean(adjusted),1 ))\n```\n  \n We now compute the ranndomization distribution of the adjusted values.  We will use 5,000 replications because this is an inportant isssue.  \n \n \n```{r Q1.3}\n\nrequire( simpleboot )\nreps <- 5000\nbootOut <- one.boot( adjusted, \n                     mean,\n                     reps )\nrd <- bootOut$t\n\n```\n\n# Computing the p-value\nBecause we have a lowe tail hypothesis we compute the proportion of observations whose value is less that the $$\\bar{y} and divide this number by the number of replications $reps$.  We do this below:  \n\n```{r,Q1.4}\n\nlowerTail <- adjusted[ rd < ybar ]\npValue <- round( length( lowerTail ) / reps, 4 )\nxx <- round( 10000 * pValue )\n\n```\n\nThe p-value for the null hypotheis is `r pValue`. \n\n## Statistical conclusion\nThis is evidence that the null hypothesis is incorrect.  \n\n*At the 5% or 0.05 level of significance we would reject the null hypothesis.  \n\n*There is insufficient evidence to reject the null hypothesis as the 0.01 or 1% level of significance.  \n\n## Managerial conclusion\n\nThere is some evidence that the pollution level has been reduced.  At the scientific standad of the 5% level of signifcant there is evidence that the pollution level has been decreased.\n\n# Coporate health care\nThe Human Resources Department of a large corporation wanted to determine if a majority of its employees were satisfied with their treatment by the corporation's health care provider. A random sample of 400 employees was selected, and 251 indicated that they were satisfied with their treatment. Does this data show at the 1% level of significance that a majority of all employees is satisfied? Suppose that the Corporation's president required that more than 60% of employees should be satisfied. Does this data support that requirement at the 10% level of significance? Construct a 95% confidence interval for the proportion of all employees who are satisfied. What sample size would be required to estimate this proportion to within $\\pm 2\\%$ with 90% confidence if no prior bounds are placed on the population proportion?\n\n## The null and alternative hypothesis\nWe want to show that the proprtion of employees that are staisfied with the corporate heath care provider is greater than 50% which is a proportion of of 0,50.  Hence our null and alternative hypotheis are\n\n$$NH: p=0.50$$\n$$AH: p>0.50$$\n\n## Synthetic sample\nWe are not given the orginal sample data but sumerized data.  We know that\n263  employees are satisified with the provider and that `r 500-251` are not satisfied.  We use these figures to construct our symethetic sample which I will call $survey$:\n\n```{r Q2.1}\nrm( list=ls() )\nn <- 500\ns <- 263\nf <- n - s\n\nsurvey <- c( rep( 1, s ),\n             rep( 0, f ))\ntable(survey)\n\nphat <- round( sum(survey)/ n, 3 )\n\n```\n\n## Computing the point estimate $\\hat{p}$\n  \n```{r}\nphat <- round( s / n )\n```\n\nThe point estimate for the proprtion is computed as follows\n    $$\\hat{p}=\\frac{x}{n}=`r phat`$$\n    \n## Adjust  the sample data to make the null hypothesis true\nWe assume that the null hypothesis is true. For proportions we can do this\nthoereticall because under the null hypothesis 50% of the sample sizes should be true and 50% should be false.  Therefore we have\n\n```{r Q2.2}\n\ntrueNH <- c( rep( 1, 250 ),\n             rep( 0, 250 ))\ntable(trueNH)\n```\n\n## Compute the randimization distribution\nWe use the trueMH to compute the randomization distribution using the bootstrap.\n\n```{r Q2.3}\n\nrequire( simpleboot )\n\nbootOut <- one.boot( trueNH,\n                     mean,\n                     10000 )\nrd <- bootOut$t\n\nggplot( data.frame( rd ),\n        aes(x=rd)) +\n    geom_histogram(  binwidth=0.005,\n                      color='blue',\n                      fill='yellow') +\n    geom_segment( x=phat, y=0,\n                  xend = phat, yend=1100) +\n    xlab( expression( hat(p) )) +\n    ylab( \"Frequency \") +\n    ggtitle( \"Bootstrap sampling distrubtion of Null Hypothesis\" )\n\n```\n\n## Computing the p-value\nThe alternative hypothesis is an upper-tail hypothesis.  Therefore we count all the randomization distribution values and divide the replicaltions.  \n\n```{r Q2.4}\ncount <- length( rd[rd>phat] )\npValue <- round( count / 10000, 4 ) \n\n```\n  \n $$pValue=1157$$\n \n## Statistical conclusion\n Because the p-value=0.1157 is not less than 0.05 there is not enough sample evidence to reject the null hypothesis.  \n \n## Managerial conclusion\nThere is insufficient sample evidence to conclude that more than 50% of our employess approve of our healthcare provider.  \n\n# 3: Commute Atlanta: Is there a difference mean commutetime driving home between genders\nWe want dtermine if there is a difference between the mean commute times in Atlanta for different genders.  \n\n## The data\nThe data can be accessed in the R-package $LOck5Data$ in the Coomute Atlanta.  We need to divide the data into two subsramples based on the sex driver.  We are only interest in the variable $Time$ which is the $4^{th}$ variable in the dataset.  \n\n## The hypothesis set\nWe define the following symbols  \n\nParameter | Interpretation  \n----------|---------------  \n$\\mu_M$   | Male mean commute time  \n$\\mu_F$   Female mean commute time  \n\nWe can formulate out hypotheses as follows:  \n$$NH: \\mu_M = \\mu_F$$\n$$AH: \\mu_M \\ne \\mu_F$$ \n\nA more useful but equivalent formulation of our hypothesis set is \n\n$$NH: \\mu_M - \\mu_F = 0$$\n$$AH: \\mu_M - \\mu_F = 0$$ \n\n## The data set \n\nThe dataset can be found in the R-package $Lock5Data.  The data frame name is $CommuteAtlanta$.  We need to create two subsamples based on gender.  We are only interested in the compute time variable $Time$.  \n\nThe chunk below shows how to the carry out these tasks.\n\n```{r, Q3.0}\nrm(list=ls())\nset.seed( 14925 )\n\nrequire( Lock5Data )\ndata( CommuteAtlanta )\nhead( CommuteAtlanta )\n\nMales   <- CommuteAtlanta[CommuteAtlanta$Sex==\"M\",4]\nFemales <- CommuteAtlanta[CommuteAtlanta$Sex==\"F\",4]\n\n```\n\n## Graphical and describptive statistics\nWe should always polt the data when it is qunatitative.  Because we are comparing nultiple sub-populations we use comparitive boxplots.  Note that we need the orginal data frame $CommuteAtlanta$ to plot this data.\n\n```{r Q3.1}\nrequire( ggplot2 )\n \nggplot( CommuteAtlanta,\n        aes( x=Sex, y=Time)) +\n    geom_boxplot() +\n    xlab( \"Gender\" ) +\n    ylab( \"Time in minutes\" ) +\n    ggtitle( \"Commute Atlanta \\n Commute time by gender\")\n\nbarM     <- round( mean( Males), 1 )\nbarF     <- round( mean( Females ), 1 )\nbarDif  <- barM - barF    \n\n```\nWe have the following sample statistics:\n\n$$\\bar{y}_M = `r barM`$$\n$$\\bar{y}_F =`r barF`$$\n$$\\bar{y}-\\bar{y}_F = `r barDif`$$\n\n## Adjusting the sample data to make the null hypothesis true\nWe the null hypothis value is zero to adjust the sample to make the null hypotheis true all we need to do is to subtatct the means of each sub-sample:\n\n```{r Q3.2}\n\nadjM <- Males - barM\nadjF <- Females - barF\nround( mean( adjM ), 1 )\nround( mean( adjF ), 1 )\n\n\n```\n\n\n## Creating the ranomized distribution\nBecause we have two populations we must use the R-function $two.boot$ in the  $simpleboot$ package.\n\n```{r Q3.3}\n  \nrequire( simpleboot )\n\nbootOut <- two.boot( adjM, \n                     adjF,\n                     mean,\n                     5000 )\nrd <- bootOut$t\n\nggplot( data.frame( rd ),\n        aes( x = rd )) +\n    geom_histogram( binwidth=0.5,\n                    color=\"blue\",\n                    fill=\"yellow\") +\n    xlab( expression(bar(y)[M]-bar(y)[F]) ) +\n    ylab( \"Frequency\" ) +\n    ggtitle( expression( paste(\"Bootstrap sanpling distribution of \", \n                        bar(y)[M]-bar(y)[F]) ))\n    \n```\n\n## Compute the pvalue using the sample statistic\nThe computation of the p-value is more complex in two tail tests than in single tail tests.  We must include areas from both tails.  If the sampling distribution is syetric we can approximate the p-vlaue by multiply in the p-value as if we had a one-tail by two in the tail that test statstic is found.\n\n```{r !3.4}\ncount <- length( rd[rd>=barDif])\npValue <- round( 2 * count/5000, 4 )\n\n```\n\n$$p-value=`r pValue`$$\n\n## Statistical conclusion\nThe p-value of `r pValue` is less than 0.05 so we shoulds reject the sample data is inconsistent with the null hypothesis.\n\n## Magaerial Conclusion\nThere is mildly strong evidence that the null hypotheis that the mean commute time is the same for both males and females is incorrect.\n\n",
    "created" : 1445530390632.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4005728032",
    "id" : "19C3C011",
    "lastKnownWriteTime" : 1445544865,
    "path" : "C:/Users/Craig/BSTAT3322/HYpothesisTesting/HTWRD.Rmd",
    "project_path" : "HTWRD.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}