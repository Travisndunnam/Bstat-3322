hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=predictY( 86 ),
x=86, y=114,
color="red",
linetype=2 )
predictY <- function( X ){
betaHat <- coef( fit )
beta[1] + beta[2] + x
}
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=predictY( 86 ),
xend=86, yend=114,
color="red",
linetype=2 )
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=predictY( 86 ),
xend=86, ye=114,
color="red",
linetype=2 )
coef(fit)
DF[order( DF$X ), ]
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=3 )
DF
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segement",
x=86, y=yBar,
xend=86, yend=105.44,
linetype=2,
color="dark greed"
)
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segement",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="dark greed"
)
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="dark greed"
)
set.seed( 1123 )
n <- 25
X <- round( rnorm( n, 80, 5 ))
Y <- 40 + 0.75 * X
Y <- round(Y + rnorm( length(Y), 0, 6))
X<- round( X )
y <- round( Y )
Xbar <- mean( X )
Ybar <- mean( Y )
Means <- data.frame( Xbar, Ybar )
DF <- data.frame( X, Y )
fit <- lm( Y ~ X, data=DF)
DF$Yhat <- fitted.values( fit )
head(DF)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="dark green"
)
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="green") +
annotate( "text",
x=86, y=110,
label="Residual or in-modeled variation",
color="red" )
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="green") +
annotate( "text",
x=86, y=110,
label="Residual or in-modeled variation",
size=3,
hjust=1,
color="red" )
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="green") +
annotate( "text",
x=86, y=110,
label="Residual or in-modeled variation",
size=2.5,
hjust=1,
color="red" )
ggplot( DF,
aes(x=X, y=Y )) +
geom_point() +
geom_smooth( method=lm,
se=FALSE ) +
geom_point( aes( y=Yhat),
color="blue") +
geom_point( data=Means,
aes( x=Xbar, y=Ybar),
size=4,
color="blue") +
geom_vline( x=Xbar,
linetype=2 ) +
geom_hline( y=Ybar,
linetype=2 ) +
annotate( "text",
x=Xbar+0.5, y=91,
label="bar(X)",
parse=TRUE,
hjust=0 ) +
annotate( "text",
x=73, y=Ybar+2,
label="bar(Y)",
parse=TRUE,
hjust=0 ) +
annotate( "segment",
x=86, y=105.43654,
xend=86, yend=114,
color="red",
linetype=2 ) +
annotate( "segment",
x=86, y=Ybar,
xend=86, yend=105.44,
linetype=2,
color="blue") +
annotate( "text",
x=87, y=111,
label="Residual",
size=2.5,
hjust=0,
color="red" )
